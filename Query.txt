SELECT DISTINCT Ordini.[Id Ord], Ordini.[Tipo Ord] AS Tipo, Ordini.[N Ord] AS Numero, Ordini.[Data Ord] AS Data, Ordini.Anno, Anagrafica.CodAnag AS Codice, Ordini.[Ragione sociale], IIf([stato]=0,"inserito",IIf([stato]=1,"stampato","Bloccato")) AS [Stato ord], Ordini.[Data consegna] AS Consegna, Ordini.ValidoFinoAl AS Validità, [tabella pagamenti].Descrizione AS Pagamento, Ordini.Rif1 AS [Ns Riferimenti], Ordini.Rif2 AS [Vs Riferimenti], IIf(Not IsNull([idsped]),[anagrafica spedizioni].[Ragione Sociale] & " " & [anagrafica spedizioni].Indirizzo & " " & [anagrafica spedizioni].Località,IIf(Not IsNull(anagrafica_1.[id anag]),anagrafica_1.[Ragione Sociale] & " " & anagrafica_1.Indirizzo & " " & anagrafica_1.Località)) AS Destinazione, Ordini.TotImp, Ordini.TotNI, Ordini.Cambio, Temp_Ordini_Interroga.ApertoEuro, Temp_Ordini_Interroga.TotaleEuro, Ordini.Sospeso
FROM ((((Ordini INNER JOIN Anagrafica ON Ordini.[Id anag] = Anagrafica.[Id anag]) INNER JOIN [tabella pagamenti] ON Ordini.[Id pagamento] = [tabella pagamenti].[Id pagamento]) LEFT JOIN [anagrafica spedizioni] ON (Ordini.DestSped = [anagrafica spedizioni].CodSped) AND (Ordini.Dest = [anagrafica spedizioni].[Id anag])) LEFT JOIN Anagrafica AS Anagrafica_1 ON Ordini.Dest = Anagrafica_1.[Id anag]) INNER JOIN Temp_Ordini_Interroga ON Ordini.[Id Ord] = Temp_Ordini_Interroga.IdOrd
ORDER BY Ordini.Anno DESC , Ordini.[Data Ord] DESC , Ordini.[N Ord] DESC;

SELECT [Ordini sotto].[id sottoOrd], [Ordini sotto].IdSottoOrigine, [Ordini sotto].Ordine, [Ordini sotto].[Id ord], [Ordini sotto].Codart, [Ordini sotto].Descrizione, [Ordini sotto].[Data Conferma], [Ordini sotto].NoteDescr, [Ordini sotto].Quantità, [Ordini sotto].[Qtà Evasa], [Quantità]-[Qtà Evasa] AS [Q Residua], [Ordini sotto].Prezzo, [Ordini sotto].Totriga, [Ordini sotto].Omaggi, [Ordini sotto].Consegna, [Ordini sotto].Saldato, anagrafica.[Ragione sociale] AS Destinatario, IIf([Esito]=0,"",IIf([esito]=1,"Confermato","Rifiutato")) AS [Esito Preventivo], [Ordini sotto].EsitoNote AS [Note Esito], [Ordini sotto].Sconto1, [Ordini sotto].Sconto2, [Ordini sotto].Sconto3, [Ordini sotto].Sconto4, [Ordini sotto].Provv
FROM ([Ordini sotto] LEFT JOIN anagrafica ON [Ordini sotto].Sped = anagrafica.[Id anag]) INNER JOIN ordini ON [Ordini sotto].[Id ord] = ordini.[Id Ord]
WHERE ((([Ordini sotto].[Id ord])=[forms]![Ordini Interroga]![IdTemp]) AND ((IIf([Forms]![Ordini Interroga]![tipoord]=3,3,[saldato]))=[Forms]![Ordini Interroga]![tipoord]) AND ((IIf([EsitoRighe]=9,9,[Esito]))=[EsitoRighe]))
ORDER BY [Ordini sotto].Ordine, [Ordini sotto].[id sottoOrd];
